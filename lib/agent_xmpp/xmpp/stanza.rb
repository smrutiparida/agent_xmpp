# Original from XMPP4R - XMPP Library for Ruby Website::http://home.gna.org/xmpp4r/
##############################################################################################################
module AgentXmpp

  #####-------------------------------------------------------------------------------------------------------
  module Xmpp

    #####-------------------------------------------------------------------------------------------------------
    class Stanza < Element

      #.......................................................................................................
      def Stanza.answer(xmppstanza, import=true)
        x = xmppstanza.class.new
        if import
          x.import(xmppstanza)
        end
        x.from = xmppstanza.to
        x.to = xmppstanza.from
        x.id = xmppstanza.id
        x
      end

      #.......................................................................................................
      def error
        first_element('error')
      end

      #.......................................................................................................
      def answer(import=true)
        Stanza.answer(self, import)
      end

      #.......................................................................................................
      def normalize
      end

      #.......................................................................................................
      def to
        (a = attribute('to')).nil? ? a : JID.new(a.value)
      end

      #.......................................................................................................
      def to=(v)
        add_attribute('to', v ? v.to_s : nil)
      end

      #.......................................................................................................
      def set_to(v)
        self.to = v
        self
      end

      #.......................................................................................................
      def from
        (a = attribute('from')).nil? ? a : JID.new(a.value)
      end

      #.......................................................................................................
      def from=(v)
        add_attribute('from', v ? v.to_s : nil)
      end

      #.......................................................................................................
      def set_from(v)
        add_attribute('from', v ? v.to_s : nil)
        self
      end

      #.......................................................................................................
      def id
        (a = attribute('id')).nil? ? a : a.value
      end

      #.......................................................................................................
      def id=(v)
        add_attribute('id', v.to_s)
      end

      #.......................................................................................................
      def set_id(v)
        add_attribute('id', v.to_s)
        self
      end

      #.......................................................................................................
      def type
        stanza_type = attributes['type']
        stanza_type.nil? ? nil : stanza_type.to_sym
      end

      #.......................................................................................................
      def type=(t)
        attributes['type'] = t.to_s
      end

      #.......................................................................................................
      def set_type(t)
        self.type = t
        self
      end
      
    #### XMPPStanza
    end
    
  #### XMPP
  end

#### AgentXmpp
end
